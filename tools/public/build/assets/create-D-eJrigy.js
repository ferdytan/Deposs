import{m as S,r as m,j as e,L as k}from"./app-DI4TLJC4.js";import{H as A}from"./heading-small-CE2rDdbC.js";import{B as v}from"./app-logo-icon-eQkH5wY8.js";import{I as c}from"./input-DsZk_lCm.js";import{L as n}from"./label-QeNiCfoM.js";import{A as F}from"./app-layout-Cyq646XZ.js";import{C as L}from"./layout-D1LTn9Z4.js";/* empty css            */import"./index-C3CP_8mx.js";import"./Combination-BF_CChef.js";import"./index-DOdMbcQI.js";import"./index-Dx9LJXF4.js";function K(){const{data:t,setData:i,post:f,processing:h,errors:r}=S({name:"",address:"",city:"",province:"",phone:"",email:"",product_prices:[]}),[p,N]=m.useState([]),[o,x]=m.useState([]),[u,b]=m.useState(""),C=s=>{s.preventDefault(),f(route("customers.store"))},w=async s=>{try{const l=await(await fetch(route("products.search",{search:s}))).json();N(l)}catch(a){console.error("Gagal mengambil produk:",a)}};m.useEffect(()=>{const s=setTimeout(()=>{w(u)},300);return()=>clearTimeout(s)},[u]);const _=s=>{o.includes(s.id)||(x([...o,s.id]),i("product_prices",[...t.product_prices,{product_id:s.id,price_20ft:"",price_40ft:""}]))},P=s=>{confirm("Yakin ingin menghapus produk ini dari daftar harga custom?")&&(x(o.filter(a=>a!==s)),i("product_prices",t.product_prices.filter(a=>a.product_id!==s)))},g=(s,a,l)=>{const d=[...t.product_prices];d[s][a]=l,i("product_prices",d)};function j(s){if(!s)return"";const a=typeof s=="number"?s:parseInt(s.replace(/\D/g,""),10);return isNaN(a)?"":a.toLocaleString("id-ID")}function y(s){return s.replace(/\D/g,"")}return e.jsxs(F,{children:[e.jsx(k,{title:"Create Customer"}),e.jsx(L,{children:e.jsxs("div",{className:"max-w-3xl space-y-6 p-4 sm:p-6",children:[e.jsx(A,{title:"Create New Customer",description:"Hanya nama yang wajib diisi. Harga custom produk opsional (20' dan 40')."}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name",children:"Customer Name"}),e.jsx(c,{id:"name",name:"name",value:t.name,onChange:s=>i("name",s.target.value),placeholder:"PT. Sejuta Rasa",required:!0}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",name:"email",type:"email",value:t.email??"",onChange:s=>i("email",s.target.value),placeholder:"order@tigarasa.com"}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"address",children:"Address"}),e.jsx(c,{id:"address",name:"address",value:t.address??"",onChange:s=>i("address",s.target.value),placeholder:"Jl. Kalianak Utara"}),r.address&&e.jsx("p",{className:"text-sm text-red-500",children:r.address})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"city",children:"City"}),e.jsx(c,{id:"city",name:"city",value:t.city??"",onChange:s=>i("city",s.target.value),placeholder:"Surabaya"}),r.city&&e.jsx("p",{className:"text-sm text-red-500",children:r.city})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"province",children:"Province"}),e.jsx(c,{id:"province",name:"province",value:t.province??"",onChange:s=>i("province",s.target.value),placeholder:"East Java"}),r.province&&e.jsx("p",{className:"text-sm text-red-500",children:r.province})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(c,{id:"phone",name:"phone",value:t.phone??"",onChange:s=>i("phone",s.target.value),placeholder:"628122224445"}),r.phone&&e.jsx("p",{className:"text-sm text-red-500",children:r.phone})]})}),e.jsxs("div",{className:"space-y-4 rounded-md border border-gray-200 bg-white p-4",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Custom Container Pricing (20' & 40')"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Atur harga khusus per produk. Hanya 20' dan 40' yang digunakan."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"product-search",children:"Search Products"}),e.jsx(c,{id:"product-search",placeholder:"Cari produk...",value:u,onChange:s=>b(s.target.value)})]}),e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto rounded border",children:p.length>0?p.map(s=>{const a=o.includes(s.id);return e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-gray-50",children:[e.jsx("span",{className:"text-sm",children:s.name}),e.jsx(v,{type:"button",size:"sm",variant:a?"destructive":"default",onClick:()=>a?P(s.id):_(s),children:a?"Remove":"Add"})]},s.id)}):e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No products found."})}),t.product_prices.length>0&&e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"20'"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"40'"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.product_prices.map((s,a)=>{var l;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm whitespace-nowrap text-gray-800",children:((l=p.find(d=>d.id===s.product_id))==null?void 0:l.name)||`Product ID ${s.product_id}`}),e.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:e.jsx(c,{type:"text",inputMode:"numeric",value:j(s.price_20ft),onChange:d=>g(a,"price_20ft",y(d.target.value)),placeholder:"0",className:"w-full text-right"})}),e.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:e.jsx(c,{type:"text",inputMode:"numeric",value:j(s.price_40ft),onChange:d=>g(a,"price_40ft",y(d.target.value)),placeholder:"0",className:"w-full text-right"})})]},s.product_id)})})]})})]}),e.jsxs(v,{type:"submit",disabled:h,className:"w-full bg-blue-600 hover:bg-blue-700 sm:w-auto",children:[h&&e.jsx("span",{className:"mr-2 animate-spin",children:"‚óè"}),"Create Customer"]})]})]})})]})}export{K as default};
