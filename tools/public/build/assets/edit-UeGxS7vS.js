import{K as A,m as F,r as m,j as e,L}from"./app-DI4TLJC4.js";import{H as D}from"./heading-small-CE2rDdbC.js";import{B as b}from"./app-logo-icon-eQkH5wY8.js";import{I as d}from"./input-DsZk_lCm.js";import{L as l}from"./label-QeNiCfoM.js";import{A as H}from"./app-layout-Cyq646XZ.js";import{C as T}from"./layout-D1LTn9Z4.js";/* empty css            */import"./index-C3CP_8mx.js";import"./Combination-BF_CChef.js";import"./index-DOdMbcQI.js";import"./index-Dx9LJXF4.js";function O(){const{customer:i,products:_,product_prices:h}=A().props,{data:t,setData:c,put:C,processing:x,errors:r}=F({name:i.name,address:i.address??"",city:i.city??"",province:i.province??"",phone:i.phone??"",email:i.email??"",product_prices:h??[]}),[u,w]=m.useState(""),[g,P]=m.useState([]),[p,j]=m.useState(h.map(a=>a.product_id)),y=async a=>{try{const o=await(await fetch(route("products.search",{search:a}))).json();P(o)}catch(s){console.error("Gagal mengambil produk:",s)}};m.useEffect(()=>{y("")},[]),m.useEffect(()=>{const a=setTimeout(()=>{y(u)},300);return()=>clearTimeout(a)},[u]);const S=a=>{p.includes(a.id)||(j([...p,a.id]),c("product_prices",[...t.product_prices,{product_id:a.id,price_20ft:"",price_40ft:""}]))},k=a=>{confirm("Yakin ingin menghapus produk ini dari daftar harga custom?")&&(j(p.filter(s=>s!==a)),c("product_prices",t.product_prices.filter(s=>s.product_id!==a)))},v=(a,s,o)=>{const n=[...t.product_prices];n[a][s]=o,c("product_prices",n)},E=a=>{a.preventDefault(),C(route("customers.update",i.id))};function f(a){if(!a)return"";const s=typeof a=="number"?a:parseInt(a.replace(/\D/g,""),10);return isNaN(s)?"":s.toLocaleString("id-ID")}function N(a){return a.replace(/\D/g,"")}return e.jsxs(H,{children:[e.jsx(L,{title:`Edit ${i.name}`}),e.jsx(T,{children:e.jsxs("div",{className:"max-w-3xl space-y-6 p-4 sm:p-6",children:[e.jsx(D,{title:`Edit Customer: ${i.name}`,description:"Hanya 20' dan 40' yang digunakan. Harga global tidak digunakan."}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Customer Name"}),e.jsx(d,{id:"name",name:"name",value:t.name,onChange:a=>c("name",a.target.value),placeholder:"PT. Sejuta Rasa",required:!0}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",name:"email",type:"email",value:t.email??"",onChange:a=>c("email",a.target.value),placeholder:"order@tigarasa.com"}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"address",children:"Address"}),e.jsx(d,{id:"address",name:"address",value:t.address??"",onChange:a=>c("address",a.target.value),placeholder:"Jl. Kalianak Utara"}),r.address&&e.jsx("p",{className:"text-sm text-red-500",children:r.address})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"city",children:"City"}),e.jsx(d,{id:"city",name:"city",value:t.city??"",onChange:a=>c("city",a.target.value),placeholder:"Surabaya"}),r.city&&e.jsx("p",{className:"text-sm text-red-500",children:r.city})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"province",children:"Province"}),e.jsx(d,{id:"province",name:"province",value:t.province??"",onChange:a=>c("province",a.target.value),placeholder:"East Java"}),r.province&&e.jsx("p",{className:"text-sm text-red-500",children:r.province})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Phone"}),e.jsx(d,{id:"phone",name:"phone",value:t.phone??"",onChange:a=>c("phone",a.target.value),placeholder:"628122224445"}),r.phone&&e.jsx("p",{className:"text-sm text-red-500",children:r.phone})]})}),e.jsxs("div",{className:"space-y-4 rounded-md border border-gray-200 bg-white p-4",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Custom Container Pricing (20' & 40')"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Hanya 20' dan 40' yang digunakan. Harga global dihapus."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"product-search",children:"Search Products"}),e.jsx(d,{id:"product-search",placeholder:"Cari produk...",value:u,onChange:a=>w(a.target.value)})]}),e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto rounded border",children:g.length>0?g.map(a=>{const s=p.includes(a.id);return e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-gray-50",children:[e.jsx("span",{className:"text-sm",children:a.name}),e.jsx(b,{type:"button",size:"sm",variant:s?"destructive":"default",onClick:()=>s?k(a.id):S(a),children:s?"Remove":"Add"})]},a.id)}):e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No products found."})}),t.product_prices.length>0&&e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"20'"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"40'"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.product_prices.map((a,s)=>{var o;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm whitespace-nowrap text-gray-800",children:((o=_.find(n=>n.id===a.product_id))==null?void 0:o.name)||`Product ID ${a.product_id}`}),e.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:e.jsx(d,{type:"text",inputMode:"numeric",value:f(a.price_20ft),onChange:n=>v(s,"price_20ft",N(n.target.value)),placeholder:"0",className:"w-full text-right"})}),e.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:e.jsx(d,{type:"text",inputMode:"numeric",value:f(a.price_40ft),onChange:n=>v(s,"price_40ft",N(n.target.value)),placeholder:"0",className:"w-full text-right"})})]},a.product_id)})})]})})]}),e.jsxs(b,{type:"submit",disabled:x,className:"w-full bg-blue-600 hover:bg-blue-700 sm:w-auto",children:[x&&e.jsx("span",{className:"mr-2 animate-spin",children:"‚óè"}),"Update Customer"]})]})]})})]})}export{O as default};
